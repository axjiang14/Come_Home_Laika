<!doctype html> 
<html lang="en"> 
<head> 
	<meta charset="UTF-8" />
	<title>No Pain, No Game</title>
	<script src="//cdn.jsdelivr.net/phaser/2.6.2/phaser.min.js"></script>
    <script src = "solarSystem.js"></script>
    <script src = "gameOverState.js"></script>
    <script src = "plutoState.js"></script>
    <script src = "main.js"></script>
	<style type="text/css">
		body {
			margin: 0;
		}
	</style>
</head>
<body>

<script type="text/javascript">

    
var game = new Phaser.Game(800, 600, Phaser.AUTO, '');//, {preload: preload, create: create, update: update});

var cursors;
var platforms;
var spaceBGM;
var buttonBGM;
var player;

var spaceship;
var spaceshipGroup;
var planetsUnlocked = 0;
var hp;

var score = 0;
var scoreText;

var ticks = 0;
var ticksText;

var spawnTicks = 100;
var spawnTicksText;

var gameOverText;

var aliens;
var alienBullets;
var diamonds;
var bullets; 
var weapon; // this is barrel that follows the pointer

var bulletSpeed = 1000;
var nextFire = 0;
var fireRate = 500;

game.state.add('solarSystem', solarSystem); //starting state 
game.state.add('plutoState', plutoState);
game.state.add('gameOverState', gameOverState); // need restart button that returns solar System.
game.state.start('plutoState'); // set start until add change state funciton

function collectAlien(player, alien){
	game.state.start('gameOverState');
	alien.kill();
}

function killPlayer(player, alienBullet){
	alienBullet.destroy();
	//console.log('Player got shot!');
	onPlayerHit();
}
    
function killaliens(bullet, alien){ // kill aliens with bullet
    score += 2;
    alien.destroy();
    bullet.kill();
}

function killBullet(bullet, platform) {
	bullet.kill();
}

function displayPlanetInfo(){
    // we need to display planet info when it is clicked once.
    // display enter button
}    
function enterPlanet(){
    game.state.start('plutoState');
    // we need to enter planet when we click that enter button
    // change state() 
}

function handle_alien(player, alien, alien_bullets) {
	px = player.body.x;
	py = player.body.y;
	ax = alien.body.x;
	ay = alien.body.y;
	
	var distance = Phaser.Math.distance(px, py, ax, ay);
	if(distance <= 200 && --alien.shoot_ticks <= 0) {
		alien.shoot_ticks = 100;
			
		var bullet = alien_bullets.create(ax + 16, ay, 'bullet');
		game.physics.arcade.moveToXY(bullet, px + 20, py + 20, bulletSpeed / 5);
		bullet.rotation = game.physics.arcade.angleToXY(bullet, px, py, game.world);
	}
	--alien.shoot_ticks;
}
    
</script>

</body>
</html>
